(window._vfP=window._vfP||[]).push([[190],{635:function(t,e,n){"use strict";n.r(e),n.d(e,"storeModule",(function(){return p}));n(26),n(3),n(52),n(44),n(58),n(17),n(15),n(16),n(57);var u=n(0),r=n(405);function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(t);e&&(u=u.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,u)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){c(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function c(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var _={[u.Uc]:function(t,e,n,r){return function(n){var i=t[n];if(i){var c=r[u.Qb];return o(o({},i),{},{thread_palette:e[u.Wc](n),visible_content:i.visible_content.filter(c),realtime_content:i.realtime_content.filter(c)})}}},[u.Zc]:function(t,e,n,r){return function(t){var n=e[u.Uc](t);if(n){var i=r[u.cb],c=r[u.db];return o(o({},n),{},{pinned_content:n.visible_content.filter(i),unpinned_content:n.visible_content.filter(c)})}}},[u.vd]:function(t,e,n,r){return function(e){return t[e].visible_content.filter(r[u.Qb])}},[u.Vc]:function(t){return function(e){var n=t[e],u=n.total_content,r=n.visible_content,i=n.realtime_content;return u-r.length-i.length}},[u.sd]:function(t,e,n,r){return function(e){return t[e].visible_replies.map(r[u.R])}},[u.Xc]:function(t){return function(e){return t[e].realtime_content.length}},[u.Cc]:function(t){return function(e){return t[e].selected_content}},[u.cc]:function(t){return function(e){var n=e.content_uuid,u=e.thread_uuid;return t[u].unread_reply_content.includes(n)}},[u.bc]:function(t){return function(e){var n=e.content_uuid,u=e.thread_uuid;return t[u].unread_mention_content.includes(n)}},[u.Hb]:function(t){return function(e){return Boolean(t[e].unread_reply_content.length)}},[u.Fb]:function(t){return function(e){return Boolean(t[e].unread_mention_content.length)}},[u.Gb]:function(t,e,n,r){return function(e){var n=e.thread_uuid,i=e.subthread_uuid;return Boolean(t[n].unread_reply_content.filter((function(t){return r[u.R](t).parent_uuid===i})).length)}},[u.Eb]:function(t,e,n,r){return function(e){var n=e.thread_uuid,i=e.subthread_uuid;return Boolean(t[n].unread_mention_content.filter((function(t){return r[u.R](t).parent_uuid===i||r[u.gd](t).target_uuid===i})).length)}},[u.hd]:function(t,e,n,r){return function(e){return t[e].unread_reply_content.map(r[u.R])}},[u.Ib]:function(t,e,n,r){return function(e){return t[e].unread_reply_content.filter(r[u.X]).length>0}},[u.Wc]:function(t){return function(e){var n=t[e],u=n.unread_mention_content,i=n.unread_reply_content;return u.length>0?r.a.MENTION:i.length>0?r.a.ACCENT:r.a.LIGHT_PRIMARY}},[u.l]:function(t,e,n,r){return function(n){var i=e[u.vd](n),o=r[u.zd](n),c=o.promo_interval,_=o.first_promo_position,a=t[n].base_promo_uuid,d=a?i.indexOf(a):i.length-1,l=a?d+_-1:d;return i.filter((function(t,e){return!(e!==l||!a)||(e>l&&(e-l)%c==0||!!(e<d&&(l-e)%c==0))}))}},[u.ac]:function(t,e){return function(t,n){return e[u.l](t).includes(n)}}},a=(n(38),n(32),n(189),n(329),n(2)),d=n(47),l=n(37),s=Object(d.b)(l.default,"thread_uuid",(function(t){return{thread_uuid:t,thread_top_uuid:null,visible_content:[],unread_mention_content:[],unread_reply_content:[],realtime_content:[],selected_content:[],base_promo_uuid:null,total_content:0,is_in_view:!1,page_from:null,more_available:!1}})),f={[a.R]:s,[a.ac](t,e){l.default.delete(t,e)},[a.Kb](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].visible_content=t[n].visible_content.filter((function(t){return t!==u}))},[a.Jb](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].realtime_content=t[n].realtime_content.filter((function(t){return t!==u}))},[a.z](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].visible_content.includes(u)||t[n].visible_content.push(u)},[a.xb](t,e){var n=e.thread_uuid,u=e.content_uuid;if(!t[n].visible_content.includes(u)){var r=t[n].visible_content;t[n].visible_content=[u].concat(r)}},[a.y](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].realtime_content.includes(u)||t[n].realtime_content.push(u)},[a.wb](t,e){var n=e.thread_uuid,u=e.content_uuid;if(!t[n].realtime_content.includes(u)){var r=t[n].realtime_content;t[n].realtime_content=[u].concat(r)}},[a.A](t,e){var n=e.thread_uuid,u=e.limit,r=t[n],i=r.visible_content,o=r.realtime_content,c=o.slice(0,u);t[n].realtime_content=o.slice(u),t[n].visible_content=i.concat(c)},[a.yb](t,e){var n=e.thread_uuid,u=e.limit,r=t[n],i=r.visible_content,o=r.realtime_content,c=o.slice(o.length-u,o.length);t[n].realtime_content=o.slice(0,o.length-u),t[n].visible_content=c.concat(i)},[a.ld](t,e){var n=e.thread_uuid,u=e.is_in_view;t[n].is_in_view=u},[a.N](t,e){t[e]&&(t[e].visible_content=[],t[e].page_from=null,t[e].more_available=!1)},[a.B](t,e){var n=e.thread_uuid,u=e.contents,r=e.new_page,i=void 0===r||r,o=u.map((function(t){return t.content_uuid})).filter((function(e){return!t[n].visible_content.includes(e)}));t[n].visible_content=t[n].visible_content.concat(o),t[n].realtime_content=t[n].realtime_content.filter((function(t){return!o.includes(t)})),i&&o.length&&(t[n].page_from=o[o.length-1])},[a.zb](t,e){var n=e.thread_uuid,u=e.contents.sort((function(t,e){return t.time-e.time})).map((function(t){return t.content_uuid})).filter((function(e){return!t[n].visible_content.includes(e)})),r=t[n].visible_content;t[n].visible_content=u.concat(r),t[n].realtime_content=t[n].realtime_content.filter((function(t){return!u.includes(t)})),t[n].page_from=u[0]},[a.d](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].unread_mention_content.push(u)},[a.e](t,e){var n=e.thread_uuid,u=e.content_uuid;t[n].unread_reply_content.push(u)},[a.Nb](t,e){var n=e.thread_uuid,u=e.content_uuid,r=t[n].unread_mention_content.indexOf(u);t[n].unread_mention_content.splice(r,1)},[a.Ob](t,e){var n=e.thread_uuid,u=e.content_uuid,r=t[n].unread_reply_content.indexOf(u);t[n].unread_reply_content.splice(r,1)},[a.Qb](t,e){var n=e.thread_uuid,u=e.content_uuid;if(t[n]){var r=t[n].visible_content.indexOf(u);-1!==r&&t[n].visible_content.splice(r,1)}},[a.Ib](t,e){var n=e.thread_uuid,u=e.content_uuid;if(t[n]){var r=t[n].realtime_content.indexOf(u);-1!==r&&t[n].realtime_content.splice(r,1)}},[a.lb](t,e){t[e]&&(t[e].total_content+=1)},[a.U](t,e){t[e]&&(t[e].total_content-=1)},[a.Lc](t,e){var n=e.thread_uuid,u=e.content_uuids;t[n].selected_content=t[n].selected_content.concat(u)},[a.L](t,e){t[e].selected_content=t[e].selected_content.splice()},[a.Tc](t,e){var n=e.thread_uuid,u=e.more_available;t[n].more_available=u}},v=(n(7),n(4)),h=n(167),b={[v.u](t,e){for(var n=t.getters,r=t.commit,i=t.rootGetters,o=e.content_container_uuid,c=e.contents,_=e.more_available,d={},l=0;l<c.length;l++){var s=c[l];if(s.thread_uuid===o){d[s.content_uuid]=d[s.content_uuid]||{},d[s.content_uuid].visible_content=d[s.content_uuid].visible_content||[],d[s.content_uuid].thread_uuid=s.content_uuid,d[s.content_uuid].thread_top_uuid=s.thread_uuid,d[s.content_uuid].total_content=s.total_replies;var f=(0,i[u.fd])(s.content_uuid);d[s.content_uuid].unread_mention_content=f.map((function(t){return t.content_uuid}))}else{d[s.thread_uuid]||(d[s.thread_uuid]={},d[s.thread_uuid].visible_content=[]);var v=d[s.thread_uuid].visible_content;v.push(s),v.sort((function(t,e){return t.time-e.time})),d[s.thread_uuid].page_from=v[0].content_uuid}}for(var h in d)d[h].visible_content=d[h].visible_content.map((function(t){return t.content_uuid})),r(a.R,d[h]);if(!n[u.Uc](o)){var b=Object.keys(d),p=b[0];r(a.R,{thread_uuid:o,visible_content:b,base_promo_uuid:p,page_from:b[b.length-1],more_available:_})}},[v.Sb](t,e){var n=e.content_container_uuid,r=e.thread_uuid,i=e.selected_content_uuids,o=e.fetchAction,c=t.getters,_=t.commit,d=t.dispatch,l=t.rootGetters,s=c[u.Uc](r);return function(t,e,n,r,i){if(e)return Promise.resolve();var o=t.getters,c=t.commit,_=t.dispatch,d=t.rootGetters;return _(i,{content_container_uuid:n,content_uuids:r},{root:!0}).then((function(_){var l=d[u.R](_[0]),s=[];return l.thread_uuid===n&&(s=d[u.fd](r).map((function(t){return t.content_uuid}))),c(a.R,{thread_uuid:r,thread_top_uuid:l.thread_uuid,total_content:l.total_replies,unread_mention_content:s}),e=o[u.Uc](r),function(t,e,n,r){var i=t.getters,o=t.commit,c=t.dispatch,_=t.rootGetters,d=e===n.thread_top_uuid?n.thread_uuid:n.thread_top_uuid,l=_[u.R](d);if(l){if(!i[u.Uc](d)){var s=_[u.fd](d).map((function(t){return t.content_uuid})),f={thread_uuid:d,thread_top_uuid:e,total_content:l.total_replies,unread_mention_content:s};o(a.R,f)}return o(a.B,{thread_uuid:e,contents:[l],new_page:!1}),Promise.resolve()}return c(r,{content_container_uuid:e,content_uuids:d},{root:!0}).then((function(t){var n=_[u.R](t[0]),r=_[u.fd](d).map((function(t){return t.content_uuid})),i={thread_uuid:d,thread_top_uuid:e,total_content:n.total_replies,unread_mention_content:r};o(a.R,i),o(a.B,{thread_uuid:e,contents:[n],new_page:!1})}))}(t,n,e,i)}))}(t,s,n,r,o).then((function(){if(s||(s=c[u.Uc](r)),i){_(a.L,r);var t=i.filter((function(t){return!l[u.R](t)})).join();if(t.length>0)return d(o,{content_container_uuid:n,content_uuids:t},{root:!0}).then((function(){_(a.Lc,{thread_uuid:r,content_uuids:i})}));_(a.Lc,{thread_uuid:r,content_uuids:i})}return Promise.resolve()}))},[v.c](t,e){var n=t.commit,r=t.getters,i=t.dispatch,o=t.rootGetters,c=e.content_container_uuid,_=e.parent_uuid,d=e.actor_uuid,l=e.parent_actor_uuid,s=e.thread_uuid,f=e.content_uuid,b=r[u.Uc](s);if(!b)return Promise.resolve();var p=s===c,m=o[u.a](c),g=m.thread_uuid===s||m.parent_thread_uuid===s;if(!o[u.Qb](f))return Promise.resolve();var O=b.realtime_content,y=b.visible_content,w=b.is_in_view,P=O.includes(f)||y.includes(f);if((p||g)&&P)return Promise.resolve();var R=function(t,e,n,r,i,o){var c=t[u.X](n),_=0===r.length&&i;if(e)return!h.d||_||o?a.xb:a.wb;if(c)return a.z;return a.y}(o,p,f,O,w,0===y.length);return n(R,{thread_uuid:s,content_uuid:f}),g&&m.parent_thread_uuid!==c&&n(R,{thread_uuid:m.thread_uuid,content_uuid:f}),n(a.lb,s),i(v.d,{parent_actor_uuid:l,parent_uuid:_,actor_uuid:d,content_container_uuid:c,thread_uuid:s,content_uuid:f})},[v.d](t,e){var n=t.rootGetters,r=t.commit,i=e.parent_actor_uuid,o=e.parent_uuid,c=e.actor_uuid,_=e.content_container_uuid,d=e.thread_uuid,l=e.content_uuid,s=n[u.jb];r(s===c||o===_||!(s===i)?a.e:a.d,{thread_uuid:d,content_uuid:l})},[v.Bc](t,e){var n=t.getters,r=t.commit,i=t.rootGetters,o=e.thread_uuid,c=e.content_uuid,_=i[u.R](c),d=n[u.Uc](o);if(d&&_){var l=_.content_container_uuid,s=!d.thread_top_uuid,f=l===d.thread_top_uuid,v={thread_uuid:s||f?o:d.thread_top_uuid,content_uuid:c},h=n[u.bc](v),b=n[u.cc](v);h&&r(a.Nb,v),b&&r(a.Ob,v)}}};var p=function(){return{namespaced:!0,state:function(){return{}},getters:_,actions:b,mutations:f}}}}]);
//# sourceMappingURL=threads-module-js.d067105b3fba4e971000.js.map